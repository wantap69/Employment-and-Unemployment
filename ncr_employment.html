<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Benedict Bautista">

<title>Sectoral Analysis of Employment in Metro Manila Using PSA’s LFS Data</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="ncr_employment_files/libs/clipboard/clipboard.min.js"></script>
<script src="ncr_employment_files/libs/quarto-html/quarto.js"></script>
<script src="ncr_employment_files/libs/quarto-html/popper.min.js"></script>
<script src="ncr_employment_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="ncr_employment_files/libs/quarto-html/anchor.min.js"></script>
<link href="ncr_employment_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="ncr_employment_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="ncr_employment_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="ncr_employment_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="ncr_employment_files/libs/bootstrap/bootstrap-1bc8a17f135ab3d594c857e9f48e611b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#data-cleaning" id="toc-data-cleaning" class="nav-link active" data-scroll-target="#data-cleaning">Data cleaning</a>
  <ul class="collapse">
  <li><a href="#loading-of-the-necessary-libraries" id="toc-loading-of-the-necessary-libraries" class="nav-link" data-scroll-target="#loading-of-the-necessary-libraries">Loading of the necessary libraries</a></li>
  <li><a href="#loading-the-dataset" id="toc-loading-the-dataset" class="nav-link" data-scroll-target="#loading-the-dataset">Loading the dataset</a></li>
  <li><a href="#filtering-variables" id="toc-filtering-variables" class="nav-link" data-scroll-target="#filtering-variables">Filtering variables</a></li>
  <li><a href="#relabeling-values" id="toc-relabeling-values" class="nav-link" data-scroll-target="#relabeling-values">Relabeling values</a></li>
  </ul></li>
  <li><a href="#eda" id="toc-eda" class="nav-link" data-scroll-target="#eda">EDA</a>
  <ul class="collapse">
  <li><a href="#rq-1" id="toc-rq-1" class="nav-link" data-scroll-target="#rq-1">RQ #1</a></li>
  <li><a href="#plots-of-weighted-frequency-distribution-in-major-sectors" id="toc-plots-of-weighted-frequency-distribution-in-major-sectors" class="nav-link" data-scroll-target="#plots-of-weighted-frequency-distribution-in-major-sectors">Plots of Weighted Frequency Distribution in Major Sectors</a>
  <ul class="collapse">
  <li><a href="#analysis-of-major-sector-distribution" id="toc-analysis-of-major-sector-distribution" class="nav-link" data-scroll-target="#analysis-of-major-sector-distribution">Analysis of Major Sector Distribution</a></li>
  </ul></li>
  <li><a href="#rq-2" id="toc-rq-2" class="nav-link" data-scroll-target="#rq-2">RQ #2</a></li>
  <li><a href="#plots-of-frequency-distribution-in-major-sectors" id="toc-plots-of-frequency-distribution-in-major-sectors" class="nav-link" data-scroll-target="#plots-of-frequency-distribution-in-major-sectors">Plots of Frequency Distribution in Major Sectors</a>
  <ul class="collapse">
  <li><a href="#analysis-of-the-population-of-employed-personnel-each-sector" id="toc-analysis-of-the-population-of-employed-personnel-each-sector" class="nav-link" data-scroll-target="#analysis-of-the-population-of-employed-personnel-each-sector">Analysis of the population of employed personnel each sector</a></li>
  </ul></li>
  <li><a href="#rq-3" id="toc-rq-3" class="nav-link" data-scroll-target="#rq-3">RQ #3</a>
  <ul class="collapse">
  <li><a href="#identifying-the-leading-employment-sub-sector-in-services-sector-in-ncr" id="toc-identifying-the-leading-employment-sub-sector-in-services-sector-in-ncr" class="nav-link" data-scroll-target="#identifying-the-leading-employment-sub-sector-in-services-sector-in-ncr">Identifying the Leading Employment Sub-Sector in Services Sector in NCR</a></li>
  <li><a href="#identifying-the-leading-employment-sub-sector-across-all-major-sectors." id="toc-identifying-the-leading-employment-sub-sector-across-all-major-sectors." class="nav-link" data-scroll-target="#identifying-the-leading-employment-sub-sector-across-all-major-sectors.">Identifying the Leading Employment Sub-sector Across all Major Sectors.</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#notes" id="toc-notes" class="nav-link" data-scroll-target="#notes">Notes</a></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Sectoral Analysis of Employment in Metro Manila Using PSA’s LFS Data</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Benedict Bautista </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="data-cleaning" class="level1">
<h1>Data cleaning</h1>
<p>In this phase of the study, the Labor Force Survey (LFS) dataset provided by the Philippine Statistics Authority (PSA) was utilized as the primary data source. The initial step involved identifying and selecting the key variables necessary for the analysis. Following this, the dataset underwent a data cleaning process, which included handling and removing any missing or incomplete values to ensure the accuracy and reliability of the results.</p>
<p>The following libraries will be used: <strong>tidyverse</strong> ,<strong>pander</strong> for APA tables, <strong>nortest</strong> for the test of normality, and <strong>here</strong> for easier working directory.</p>
<section id="loading-of-the-necessary-libraries" class="level2">
<h2 class="anchored" data-anchor-id="loading-of-the-necessary-libraries">Loading of the necessary libraries</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.2     ✔ tibble    3.2.1
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.0.4     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pander)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(here)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>here() starts at C:/Users/ben/Desktop/portfolio RPUB</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nortest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="loading-the-dataset" class="level2">
<h2 class="anchored" data-anchor-id="loading-the-dataset">Loading the dataset</h2>
<p>The dataset was acquired from psada.gov.ph under Labor Force Survey tab and then the month of March 2024.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="fu">here</span>(<span class="st">"LFS PUF March 2024.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="filtering-variables" class="level2">
<h2 class="anchored" data-anchor-id="filtering-variables">Filtering variables</h2>
<p>In the next step, we wish to filter variables needed for the analysis. The variables needed are <strong>PUFC15_PKB</strong> coded as <strong><em>Major industry group</em></strong> and <strong><em>Sub industry group</em></strong>, <strong>PUFREG</strong> coded as <strong><em>Region</em></strong>, <strong>PUFC09</strong> coded as <strong><em>Work indicator (1 = employed, 2 = unemployed),</em></strong> and <strong>PUFC07</strong> coded as <strong><em>Educational attainment</em></strong> and <strong>PUFWGTPRV</strong> for the <strong><em>final weight</em></strong> based on projection. Please refer to lfs_metadata (dictionary) uploaded or you can visit the site :<a href="https://psada.psa.gov.ph/catalog/LFS/about" class="uri">https://psada.psa.gov.ph/catalog/LFS/about</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># filtering values</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>data1 <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(PUFREG <span class="sc">==</span> <span class="dv">13</span>) <span class="sc">%&gt;%</span> <span class="co"># 13 for NCR</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sectors =</span> <span class="fu">case_when</span>(</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    PUFC15_PKB <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span> <span class="sc">~</span> <span class="st">"Agriculture"</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    PUFC15_PKB <span class="sc">%in%</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">43</span> <span class="sc">~</span> <span class="st">"Industry"</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    PUFC15_PKB <span class="sc">&gt;=</span> <span class="dv">45</span> <span class="sc">~</span> <span class="st">"Services"</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    T <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">sub.industry =</span> <span class="fu">case_when</span>(</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>      PUFC15_PKB <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span> <span class="sc">~</span> <span class="st">"Agriculture and Forestry"</span>,</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>      PUFC15_PKB <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"Fishing and Aquaculture"</span>,</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>      PUFC15_PKB <span class="sc">%in%</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">9</span> <span class="sc">~</span> <span class="st">"Mining and Quarying"</span>,</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>      PUFC15_PKB <span class="sc">%in%</span> <span class="dv">10</span><span class="sc">:</span><span class="dv">33</span> <span class="sc">~</span> <span class="st">"Manufacturing"</span>,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>      PUFC15_PKB <span class="sc">&gt;=</span> <span class="dv">35</span> <span class="sc">~</span> <span class="st">"Electricity, Gas, Steam, AC"</span>,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>      PUFC15_PKB <span class="sc">%in%</span> <span class="dv">36</span><span class="sc">:</span><span class="dv">39</span> <span class="sc">~</span> <span class="st">"Water Supply, Sewerage, Waste Management"</span>,</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>      PUFC15_PKB <span class="sc">%in%</span> <span class="dv">41</span><span class="sc">:</span><span class="dv">43</span> <span class="sc">~</span> <span class="st">"Construction"</span>,</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>      PUFC15_PKB <span class="sc">%in%</span> <span class="dv">45</span><span class="sc">:</span><span class="dv">47</span> <span class="sc">~</span> <span class="st">"Wholesale and Retail Trade"</span>,</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>      PUFC15_PKB <span class="sc">%in%</span> <span class="dv">49</span><span class="sc">:</span><span class="dv">53</span> <span class="sc">~</span> <span class="st">"Transportation and Storage"</span>,</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>      PUFC15_PKB <span class="sc">%in%</span> <span class="dv">55</span><span class="sc">:</span><span class="dv">56</span> <span class="sc">~</span> <span class="st">"Accommodation and Food Service Activities"</span>,</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>      PUFC15_PKB <span class="sc">%in%</span> <span class="dv">58</span><span class="sc">:</span><span class="dv">63</span> <span class="sc">~</span> <span class="st">"Information and Communication"</span>,</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>      PUFC15_PKB <span class="sc">%in%</span> <span class="dv">64</span><span class="sc">:</span><span class="dv">66</span> <span class="sc">~</span> <span class="st">"Financial and Insurance Activities"</span>,</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>      PUFC15_PKB <span class="sc">==</span> <span class="dv">68</span> <span class="sc">~</span> <span class="st">"Real Estate Activities"</span>,</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>      PUFC15_PKB <span class="sc">%in%</span> <span class="dv">69</span><span class="sc">:</span><span class="dv">75</span> <span class="sc">~</span> <span class="st">"Professional, Scientific, and Technical Activities"</span>,</span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>      PUFC15_PKB <span class="sc">%in%</span> <span class="dv">77</span><span class="sc">:</span><span class="dv">82</span> <span class="sc">~</span> <span class="st">"Administrative and Support Service Activities"</span>,</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>      PUFC15_PKB <span class="sc">==</span> <span class="dv">84</span> <span class="sc">~</span> <span class="st">"Public Administration and Defense"</span>,</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>      PUFC15_PKB <span class="sc">==</span> <span class="dv">85</span> <span class="sc">~</span> <span class="st">"Education"</span>,</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>      PUFC15_PKB <span class="sc">%in%</span> <span class="dv">86</span><span class="sc">:</span><span class="dv">88</span> <span class="sc">~</span> <span class="st">"Human Health and Social Work"</span>,</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>      PUFC15_PKB <span class="sc">%in%</span> <span class="dv">90</span><span class="sc">:</span><span class="dv">93</span> <span class="sc">~</span> <span class="st">"Arts, Entertainment and Recreation"</span>,</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>      PUFC15_PKB <span class="sc">%in%</span> <span class="dv">94</span><span class="sc">:</span><span class="dv">96</span> <span class="sc">~</span> <span class="st">"Other Service Activities"</span>,</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>      PUFC15_PKB <span class="sc">%in%</span> <span class="dv">97</span><span class="sc">:</span><span class="dv">98</span> <span class="sc">~</span> <span class="st">"Activities of Households as Employers"</span>,</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>      PUFC15_PKB <span class="sc">==</span> <span class="dv">99</span> <span class="sc">~</span> <span class="st">"Activities of Extraterritorial Orgs and Bodies"</span>,</span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>      T <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">employed =</span> <span class="fu">case_when</span>(</span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>      PUFC09_WORK <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Employed"</span>,</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>      PUFC09_WORK <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"Unemployed"</span>,</span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>      T <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sectors), <span class="sc">!</span><span class="fu">is.na</span>(sub.industry), <span class="sc">!</span><span class="fu">is.na</span>(employed))</span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a><span class="co"># select variables</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>dataset <span class="ot">&lt;-</span> data1 <span class="sc">%&gt;%</span> <span class="fu">select</span>(PUFC15_PKB, PUFREG, PUFC09_WORK, PUFC07_GRADE, PUFPWGTPRV)</span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a><span class="co"># renaming column names</span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dataset) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Industries"</span>, <span class="st">"Region"</span>, <span class="st">"Employment Status"</span>, <span class="st">"Educational Attainment"</span>, <span class="st">"Final weight"</span>)</span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dataset, <span class="at">n =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Industries Region Employment Status Educational Attainment Final weight
1          84     13                 1                  60413     3999.574
2          82     13                 1                  60003     3347.185
3          56     13                 1                  60003     3240.956
4          47     13                 1                  24015     3240.956
5          46     13                 1                  24015     2238.744
6          47     13                 1                  24015     3347.185
7          47     13                 1                  24015     3999.574
8          47     13                 1                  10018     3503.780
9          82     13                 1                  60612     2713.258
10         47     13                 1                  60002     3448.945</code></pre>
</div>
</div>
</section>
<section id="relabeling-values" class="level2">
<h2 class="anchored" data-anchor-id="relabeling-values">Relabeling values</h2>
<p>For simplicity we can rename the values from its coded ones.</p>
<p>For industries, (take note that <strong>Agriculture</strong>, <strong>Industry</strong>, and <strong>Services</strong> are the major industries) following coded values are:</p>
<span class="math display">\[\begin{array}{|l|c|c|}
\hline
\textbf{Industry} &amp; \textbf{Minimum Code} &amp; \textbf{Maximum Code} \\
\hline
\text{AGRICULTURE} &amp; 1 &amp; 3 \\
\text{Agriculture and Forestry} &amp; 1 &amp; 2 \\
\text{Fishing and Aquaculture} &amp; 3 &amp;  \\
\text{INDUSTRY} &amp; 5 &amp; 43 \\
\text{Mining and Quarrying} &amp; 5 &amp; 9 \\
\text{Manufacturing} &amp; 10 &amp; 33 \\
\text{Electricity, Gas, Steam and Airconditioning Supply} &amp; 35 &amp;  \\
\text{Water Supply, Sewerage, Waste Management} &amp; 36 &amp; 39 \\
\text{Construction} &amp; 41 &amp; 43 \\
\text{SERVICES} &amp; 45 &amp; 99 \\
\text{Wholesale and Retail Trade} &amp; 45 &amp; 47 \\
\text{Transportation and Storage} &amp; 49 &amp; 53 \\
\text{Accommodation and Food Service Activities} &amp; 55 &amp; 56 \\
\text{Information and Communication} &amp; 58 &amp; 63 \\
\text{Financial and Insurance Activities} &amp; 64 &amp; 66 \\
\text{Real Estate Activities} &amp; 68 &amp;  \\
\text{Professional, Scientific, and Technical Activities} &amp; 69 &amp; 75 \\
\text{Administrative and Support Service Activities} &amp; 77 &amp; 82 \\
\text{Public Administration and Defense} &amp; 84 &amp;  \\
\text{Education} &amp; 85 &amp;  \\
\text{Human Health and Social Work} &amp; 86 &amp; 88 \\
\text{Arts, Entertainment and Recreation} &amp; 90 &amp; 93 \\
\text{Other Service Activities} &amp; 94 &amp; 96 \\
\text{Activities of Households as Employers} &amp; 97 &amp; 98 \\
\text{Activities of Extraterritorial Orgs and Bodies} &amp; 99 &amp;  \\
\hline
\end{array}\]</span>
<p>For Educational Attainment the following coded values are:</p>
<span class="math display">\[\begin{array}{|l|c|c|}
\hline
\textbf{Educational Attainment} &amp; \textbf{Minimum Code} &amp; \textbf{Maximum Code} \\
\hline
\text{No grade completed} &amp; 0 &amp; 1000 \\
\text{Elementary Undergraduate} &amp; 10011 &amp; 10015 \\
\text{Elementary Graduate} &amp; 10016 &amp; 10018 \\
\text{Junior High School Undergraduate} &amp; 24011 &amp; 24013 \\
\text{Junior High School Completer} &amp; 24015 &amp; 24015 \\
\text{Senior High School Undergraduate} &amp; 34011 &amp; 35011 \\
\text{Senior High School Graduate} &amp; 34013 &amp; 35013 \\
\text{Post Secondary Undergraduate} &amp; 40001 &amp; 50003 \\
\text{Post Secondary Graduate} &amp; 40011 &amp; 49999 \\
\text{College Undergraduate} &amp; 60001 &amp; 69999 \\
\text{College Graduate} &amp; 60011 &amp; 89999 \\
\hline
\end{array}\]</span>
</section>
</section>
<section id="eda" class="level1">
<h1>EDA</h1>
<section id="rq-1" class="level2">
<h2 class="anchored" data-anchor-id="rq-1">RQ #1</h2>
<p>To gain an initial understanding of the dataset and address the first two research questions, this study begins with an exploratory data analysis. Specifically, it aims to describe how employed Filipino workers are distributed across the country’s major and sub industry sectors, providing foundational insights for further statistical evaluation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>dist<span class="fl">.1</span> <span class="ot">&lt;-</span> dataset <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="st">`</span><span class="at">Employment Status</span><span class="st">`</span> <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">major =</span> <span class="fu">case_when</span>(</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  Industries <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span> <span class="sc">~</span> <span class="st">"Agriculture"</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  Industries <span class="sc">%in%</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">43</span> <span class="sc">~</span> <span class="st">"Industry"</span>,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  Industries <span class="sc">%in%</span> <span class="dv">45</span><span class="sc">:</span><span class="dv">99</span> <span class="sc">~</span> <span class="st">"Services"</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  T <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>)) </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co"># aggregate the dist.1</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>major.dist <span class="ot">&lt;-</span> dist<span class="fl">.1</span> <span class="sc">%&gt;%</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(major) <span class="sc">%&gt;%</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="st">`</span><span class="at">total weight</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">Final weight</span><span class="st">`</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>major.dist <span class="ot">&lt;-</span> major.dist <span class="sc">%&gt;%</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>      major.dist,</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">major =</span> <span class="st">"TOTAL"</span>,</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">total weight</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(<span class="st">`</span><span class="at">total weight</span><span class="st">`</span>)))</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(major.dist) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Major Industry"</span>, <span class="st">"Population"</span>)</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="fu">pander</span>(major.dist,</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Total Population per Major Industry"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Total Population per Major Industry</caption>
<colgroup>
<col style="width: 23%">
<col style="width: 18%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Major Industry</th>
<th style="text-align: center;">Population</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Agriculture</td>
<td style="text-align: center;">5298</td>
</tr>
<tr class="even">
<td style="text-align: center;">Industry</td>
<td style="text-align: center;">920484</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Services</td>
<td style="text-align: center;">5276199</td>
</tr>
<tr class="even">
<td style="text-align: center;">TOTAL</td>
<td style="text-align: center;">6201981</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We cannot assume that the population is normally distributed without formally testing it. This is where the <strong>Shapiro–Francia test</strong> comes in. It is a variant of the Shapiro–Wilk test, designed to perform better with larger sample sizes. In our case, we are working with 2,580 samples drawn from a dataset containing 44,603 observations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># normality test of employed NCR citizen per major sector</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>employed <span class="ot">&lt;-</span> dist<span class="fl">.1</span> <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="st">`</span><span class="at">Employment Status</span><span class="st">`</span> <span class="sc">==</span> <span class="dv">1</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>employed <span class="sc">%&gt;%</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(major) <span class="sc">%&gt;%</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">p_value =</span> <span class="fu">sf.test</span>(<span class="st">`</span><span class="at">Final weight</span><span class="st">`</span>)<span class="sc">$</span>p.value</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  major        p_value
  &lt;chr&gt;          &lt;dbl&gt;
1 Agriculture 5.63e- 2
2 Industry    1.28e-21
3 Services    9.31e-41</code></pre>
</div>
</div>
</section>
<section id="plots-of-weighted-frequency-distribution-in-major-sectors" class="level2">
<h2 class="anchored" data-anchor-id="plots-of-weighted-frequency-distribution-in-major-sectors">Plots of Weighted Frequency Distribution in Major Sectors</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dist<span class="fl">.1</span>, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">Final weight</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>, <span class="at">bins =</span> <span class="dv">28</span>) <span class="sc">+</span>  </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> major, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of employed by Major Sector (Weighted)"</span>,</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Major Industry"</span>,</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Population"</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ncr_employment_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="analysis-of-major-sector-distribution" class="level3">
<h3 class="anchored" data-anchor-id="analysis-of-major-sector-distribution">Analysis of Major Sector Distribution</h3>
<p>A test of normality was conducted to assess the distribution of employed individuals across the major industry sectors. Results indicated that the Agriculture sector was the only one with a distribution that did not significantly deviate from normality (p = .056), whereas the Industry and Services sectors showed strong evidence against normality. Furthermore, we can notice from the graphs that Industry sector and Services sector is skewed to the right which indicate that we can utilize logarithmic transformation to the weights of Industry and Services sector to achieve normality.</p>
</section>
</section>
<section id="rq-2" class="level2">
<h2 class="anchored" data-anchor-id="rq-2">RQ #2</h2>
<p>From the code earlier we can tweak it to remove the weights (which represent the <strong>number of people in the population</strong> that each sampled respondent stands for) to get the actual frequency of each sector.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>dist<span class="fl">.2</span> <span class="ot">&lt;-</span> dataset <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="st">`</span><span class="at">Employment Status</span><span class="st">`</span> <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">major =</span> <span class="fu">case_when</span>(</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  Industries <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span> <span class="sc">~</span> <span class="st">"Agriculture"</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  Industries <span class="sc">%in%</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">43</span> <span class="sc">~</span> <span class="st">"Industry"</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  Industries <span class="sc">%in%</span> <span class="dv">45</span><span class="sc">:</span><span class="dv">99</span> <span class="sc">~</span> <span class="st">"Services"</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  T <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>)) </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co"># aggregate the dist.2</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>major.dist1 <span class="ot">&lt;-</span> dist<span class="fl">.2</span> <span class="sc">%&gt;%</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(major) <span class="sc">%&gt;%</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">frequency =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>major.dist1 <span class="ot">&lt;-</span> major.dist1 <span class="sc">%&gt;%</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>      major.dist1,</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">major =</span> <span class="st">"TOTAL"</span>,</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">frequency =</span> <span class="fu">sum</span>(frequency)))</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(major.dist1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Major Industry"</span>, <span class="st">"Population"</span>)</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="fu">pander</span>(major.dist1,</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Total Frequency per Major Industry"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Total Frequency per Major Industry</caption>
<colgroup>
<col style="width: 23%">
<col style="width: 18%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Major Industry</th>
<th style="text-align: center;">Population</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Agriculture</td>
<td style="text-align: center;">9</td>
</tr>
<tr class="even">
<td style="text-align: center;">Industry</td>
<td style="text-align: center;">427</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Services</td>
<td style="text-align: center;">2133</td>
</tr>
<tr class="even">
<td style="text-align: center;">TOTAL</td>
<td style="text-align: center;">2569</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="plots-of-frequency-distribution-in-major-sectors" class="level2">
<h2 class="anchored" data-anchor-id="plots-of-frequency-distribution-in-major-sectors">Plots of Frequency Distribution in Major Sectors</h2>
<p>We can graph it to visualize which sector contributes more in the employment in NCR.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(dist<span class="fl">.2</span>, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_rev</span>(<span class="fu">fct_infreq</span>(major)))) <span class="sc">+</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">stat =</span> <span class="st">"count"</span>, <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">after_stat</span>(count)),</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"black"</span>,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="fl">1.1</span>,</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Distribution of Employed by Major Sector"</span>,</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Major Sector"</span>,</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count"</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ncr_employment_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="analysis-of-the-population-of-employed-personnel-each-sector" class="level3">
<h3 class="anchored" data-anchor-id="analysis-of-the-population-of-employed-personnel-each-sector">Analysis of the population of employed personnel each sector</h3>
<p>Upon observing the graph we can notice that the distribution of the frequency of employed personnel across all the major sectors is not normally distributed, because it does not resemble a bell-shaped curve, which also suggest that formal test is not needed. Furthermore, most of the employed personnel in NCR falls under the Services sector placing as the most populated sector in the NCR, Industry sector placing second and Agriculture sector placing last, which indicate that Agriculture sector is the least populated among the three major sectors in NCR alone.</p>
</section>
</section>
<section id="rq-3" class="level2">
<h2 class="anchored" data-anchor-id="rq-3">RQ #3</h2>
<section id="identifying-the-leading-employment-sub-sector-in-services-sector-in-ncr" class="level3">
<h3 class="anchored" data-anchor-id="identifying-the-leading-employment-sub-sector-in-services-sector-in-ncr">Identifying the Leading Employment Sub-Sector in Services Sector in NCR</h3>
<p>Previously, we identified the total number of employed individuals across major sectors. Based on the aggregated and visualized data, it was observed that the majority of the workforce is employed in the Services sector, while the Agriculture sector had the lowest share.</p>
<p>In this section, our goal is to determine which sub-sector within the Services sector accounts for the highest number of employed individuals. To achieve this, we will aggregate relevant data and present visualizations to uncover further insights.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>sub <span class="ot">&lt;-</span> dist<span class="fl">.2</span> <span class="sc">%&gt;%</span> <span class="fu">filter</span>(major <span class="sc">==</span> <span class="st">"Services"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sector2 =</span> <span class="fu">case_when</span>(</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    Industries <span class="sc">%in%</span> <span class="dv">45</span><span class="sc">:</span><span class="dv">47</span> <span class="sc">~</span> <span class="st">"Wholesale and Retail Trade"</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    Industries <span class="sc">%in%</span> <span class="dv">49</span><span class="sc">:</span><span class="dv">53</span> <span class="sc">~</span> <span class="st">"Transportation and Storage"</span>,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    Industries <span class="sc">%in%</span> <span class="dv">55</span><span class="sc">:</span><span class="dv">56</span> <span class="sc">~</span> <span class="st">"Accommodation and Food Service Activities"</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    Industries <span class="sc">%in%</span> <span class="dv">58</span><span class="sc">:</span><span class="dv">63</span> <span class="sc">~</span> <span class="st">"Information and Communication"</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    Industries <span class="sc">%in%</span> <span class="dv">64</span><span class="sc">:</span><span class="dv">66</span> <span class="sc">~</span> <span class="st">"Financial and Insurance Activities"</span>,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    Industries <span class="sc">==</span> <span class="dv">68</span> <span class="sc">~</span> <span class="st">"Real Estate Activities"</span>,</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    Industries <span class="sc">%in%</span> <span class="dv">69</span><span class="sc">:</span><span class="dv">75</span> <span class="sc">~</span> <span class="st">"Professional, Scientific, and Technical Activities"</span>,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    Industries <span class="sc">%in%</span> <span class="dv">77</span><span class="sc">:</span><span class="dv">82</span> <span class="sc">~</span> <span class="st">"Administrative and Support Service Activities"</span>,</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    Industries <span class="sc">==</span> <span class="dv">84</span> <span class="sc">~</span> <span class="st">"Public Administration and Defense"</span>,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    Industries <span class="sc">==</span> <span class="dv">85</span> <span class="sc">~</span> <span class="st">"Education"</span>,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    Industries <span class="sc">%in%</span> <span class="dv">86</span><span class="sc">:</span><span class="dv">88</span> <span class="sc">~</span> <span class="st">"Human Health and Social Work"</span>,</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    Industries <span class="sc">%in%</span> <span class="dv">90</span><span class="sc">:</span><span class="dv">93</span> <span class="sc">~</span> <span class="st">"Arts, Entertainment and Recreation"</span>,</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    Industries <span class="sc">%in%</span> <span class="dv">94</span><span class="sc">:</span><span class="dv">96</span> <span class="sc">~</span> <span class="st">"Other Service Activities"</span>,</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    Industries <span class="sc">%in%</span> <span class="dv">97</span><span class="sc">:</span><span class="dv">98</span> <span class="sc">~</span> <span class="st">"Activies of Households as Employers"</span>,</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    Industries <span class="sc">%in%</span> <span class="dv">99</span> <span class="sc">~</span> <span class="st">"Activities of Extraterritorial Orgs and Bodies"</span>,</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>    T <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>sub.dist1 <span class="ot">&lt;-</span> sub <span class="sc">%&gt;%</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sector2) <span class="sc">%&gt;%</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">frequency =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>sub.dist1 <span class="ot">&lt;-</span> sub.dist1 <span class="sc">%&gt;%</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>      sub.dist1,</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">sector2 =</span> <span class="st">"TOTAL"</span>,</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">frequency =</span> <span class="fu">sum</span>(frequency)))</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(sub.dist1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Sub Industry"</span>, <span class="st">"Frequency"</span>)</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a><span class="fu">pander</span>(sub.dist1,</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Total Frequency per Sub Industry"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Total Frequency per Sub Industry</caption>
<colgroup>
<col style="width: 45%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Sub Industry</th>
<th style="text-align: center;">Frequency</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Accommodation and Food Service Activities</td>
<td style="text-align: center;">213</td>
</tr>
<tr class="even">
<td style="text-align: center;">Administrative and Support Service Activities</td>
<td style="text-align: center;">344</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Arts, Entertainment and Recreation</td>
<td style="text-align: center;">25</td>
</tr>
<tr class="even">
<td style="text-align: center;">Education</td>
<td style="text-align: center;">60</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Financial and Insurance Activities</td>
<td style="text-align: center;">70</td>
</tr>
<tr class="even">
<td style="text-align: center;">Human Health and Social Work</td>
<td style="text-align: center;">60</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Information and Communication</td>
<td style="text-align: center;">73</td>
</tr>
<tr class="even">
<td style="text-align: center;">Other Service Activities</td>
<td style="text-align: center;">196</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Professional, Scientific, and Technical Activities</td>
<td style="text-align: center;">49</td>
</tr>
<tr class="even">
<td style="text-align: center;">Public Administration and Defense</td>
<td style="text-align: center;">154</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Real Estate Activities</td>
<td style="text-align: center;">32</td>
</tr>
<tr class="even">
<td style="text-align: center;">Transportation and Storage</td>
<td style="text-align: center;">273</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Wholesale and Retail Trade</td>
<td style="text-align: center;">584</td>
</tr>
<tr class="even">
<td style="text-align: center;">TOTAL</td>
<td style="text-align: center;">2133</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We can graph it to observe the distribution and proportion of each Sub Industry to the overall frequency of the Services Sector.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(sub, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_rev</span>(<span class="fu">fct_infreq</span>(sector2)))) <span class="sc">+</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_text</span>(<span class="at">stat =</span> <span class="st">"count"</span>, <span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">after_stat</span>(count)),</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"white"</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="fl">1.1</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">title =</span> <span class="st">"Number of Employed Personnel per Sub-sector"</span>,</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Sub-sector"</span>,</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Count"</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ncr_employment_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>pie_data <span class="ot">&lt;-</span> sub <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="st">`</span><span class="at">Employment Status</span><span class="st">`</span> <span class="sc">==</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(sector2) <span class="sc">%&gt;%</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">percentage =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(percentage, <span class="dv">1</span>), <span class="st">"%"</span>))</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(pie_data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Sub-Industry"</span>, <span class="st">"Count"</span>, <span class="st">"Percentage"</span>, <span class="st">"Rounded"</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pie_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(<span class="st">`</span><span class="at">Sub-Industry</span><span class="st">`</span>, Percentage), <span class="at">y =</span> Percentage)) <span class="sc">+</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">fill =</span> <span class="st">"steelblue"</span>) <span class="sc">+</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(Rounded)), </span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">color =</span> <span class="st">"white"</span>, </span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">hjust =</span> <span class="fl">1.1</span>, </span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">size =</span> <span class="fl">3.5</span>) <span class="sc">+</span> </span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Percentage Distribution of Employed Personnel by Sub-sector"</span>,</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Sub-Industry"</span>,</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Percentage"</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ncr_employment_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>From the graphs presented we can observe that <strong>Wholesale and Retail Trade</strong> placed first with 584 or 27.4% employed personnel in the most populated sub-industry under Services Sector. Consequently, <strong>Administrative and Support Service Activities</strong> placed second with 344 or 16.1% employed personnel, while <strong>Transportation and Storage</strong> placed third with 273 or 12.8% employed personnel, indicating that the top three sub industries under Service sector are <strong><em>Wholesale and Retail Trade, Administrative and Support Service Activities, and Transportation and Storage</em></strong> adding up their population can add up to 1203 employed personnel making about 56.3% over the whole population of employed personnel in Services alone. This can indicate that these 3 sub industries are the most contributors to the overall population of Service sector.</p>
</section>
<section id="identifying-the-leading-employment-sub-sector-across-all-major-sectors." class="level3">
<h3 class="anchored" data-anchor-id="identifying-the-leading-employment-sub-sector-across-all-major-sectors.">Identifying the Leading Employment Sub-sector Across all Major Sectors.</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using dataset "dist.2" from earlier</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Agriculture</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>agri <span class="ot">&lt;-</span> dist<span class="fl">.2</span> <span class="sc">%&gt;%</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(major <span class="sc">==</span> <span class="st">"Agriculture"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sub_sector =</span> <span class="fu">case_when</span>(</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    Industries <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span> <span class="sc">~</span> <span class="st">"Agriculture and Forestry"</span>,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    Industries <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"Fishing and Aquaculture"</span>,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Industry</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>industry <span class="ot">&lt;-</span> dist<span class="fl">.2</span> <span class="sc">%&gt;%</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(major <span class="sc">==</span> <span class="st">"Industry"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sub_sector =</span> <span class="fu">case_when</span>(</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    Industries <span class="sc">%in%</span> <span class="dv">5</span><span class="sc">:</span><span class="dv">9</span> <span class="sc">~</span> <span class="st">"Mining and Quarrying"</span>,</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    Industries <span class="sc">%in%</span> <span class="dv">10</span><span class="sc">:</span><span class="dv">33</span> <span class="sc">~</span> <span class="st">"Manufacturing"</span>,</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    Industries <span class="sc">==</span> <span class="dv">35</span> <span class="sc">~</span> <span class="st">"Electricity, Gas, Steam, AC Supply"</span>,</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    Industries <span class="sc">%in%</span> <span class="dv">36</span><span class="sc">:</span><span class="dv">39</span> <span class="sc">~</span> <span class="st">"Water Supply, Sewerage, Waste Management"</span>,</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    Industries <span class="sc">%in%</span> <span class="dv">41</span><span class="sc">:</span><span class="dv">43</span> <span class="sc">~</span> <span class="st">"Construction"</span>,</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Services</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>services <span class="ot">&lt;-</span> dist<span class="fl">.2</span> <span class="sc">%&gt;%</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(major <span class="sc">==</span> <span class="st">"Services"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sub_sector =</span> <span class="fu">case_when</span>(</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>    Industries <span class="sc">%in%</span> <span class="dv">45</span><span class="sc">:</span><span class="dv">47</span> <span class="sc">~</span> <span class="st">"Wholesale and Retail Trade"</span>,</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>    Industries <span class="sc">%in%</span> <span class="dv">49</span><span class="sc">:</span><span class="dv">53</span> <span class="sc">~</span> <span class="st">"Transportation and Storage"</span>,</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>    Industries <span class="sc">%in%</span> <span class="dv">55</span><span class="sc">:</span><span class="dv">56</span> <span class="sc">~</span> <span class="st">"Accommodation and Food Services"</span>,</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>    Industries <span class="sc">%in%</span> <span class="dv">58</span><span class="sc">:</span><span class="dv">63</span> <span class="sc">~</span> <span class="st">"Information and Communication"</span>,</span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>    Industries <span class="sc">%in%</span> <span class="dv">64</span><span class="sc">:</span><span class="dv">66</span> <span class="sc">~</span> <span class="st">"Financial and Insurance Activities"</span>,</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>    Industries <span class="sc">==</span> <span class="dv">68</span> <span class="sc">~</span> <span class="st">"Real Estate Activities"</span>,</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>    Industries <span class="sc">%in%</span> <span class="dv">69</span><span class="sc">:</span><span class="dv">75</span> <span class="sc">~</span> <span class="st">"Professional, Scientific, and Technical Activities"</span>,</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>    Industries <span class="sc">%in%</span> <span class="dv">77</span><span class="sc">:</span><span class="dv">82</span> <span class="sc">~</span> <span class="st">"Administrative and Support Services"</span>,</span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>    Industries <span class="sc">==</span> <span class="dv">84</span> <span class="sc">~</span> <span class="st">"Public Administration and Defense"</span>,</span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>    Industries <span class="sc">==</span> <span class="dv">85</span> <span class="sc">~</span> <span class="st">"Education"</span>,</span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>    Industries <span class="sc">%in%</span> <span class="dv">86</span><span class="sc">:</span><span class="dv">88</span> <span class="sc">~</span> <span class="st">"Human Health and Social Work"</span>,</span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>    Industries <span class="sc">%in%</span> <span class="dv">90</span><span class="sc">:</span><span class="dv">93</span> <span class="sc">~</span> <span class="st">"Arts, Entertainment and Recreation"</span>,</span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>    Industries <span class="sc">%in%</span> <span class="dv">94</span><span class="sc">:</span><span class="dv">96</span> <span class="sc">~</span> <span class="st">"Other Service Activities"</span>,</span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>    Industries <span class="sc">%in%</span> <span class="dv">97</span><span class="sc">:</span><span class="dv">98</span> <span class="sc">~</span> <span class="st">"Household Employers"</span>,</span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>    Industries <span class="sc">==</span> <span class="dv">99</span> <span class="sc">~</span> <span class="st">"Extraterritorial Orgs and Bodies"</span>,</span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>all <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(agri, industry, services)</span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>freq_table <span class="ot">&lt;-</span> all <span class="sc">%&gt;%</span></span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sub_sector)) <span class="sc">%&gt;%</span></span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(major, sub_sector)</span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a>total_row <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a>  <span class="at">major =</span> <span class="st">"Total"</span>,</span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a>  <span class="at">sub_sector =</span> <span class="st">"-"</span>,</span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a>  <span class="at">n =</span> <span class="fu">sum</span>(freq_table<span class="sc">$</span>n)</span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a>freq_table <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(freq_table, total_row)</span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true" tabindex="-1"></a><span class="fu">pander</span>(freq_table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 44%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">major</th>
<th style="text-align: center;">sub_sector</th>
<th style="text-align: center;">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Agriculture</td>
<td style="text-align: center;">Agriculture and Forestry</td>
<td style="text-align: center;">2</td>
</tr>
<tr class="even">
<td style="text-align: center;">Agriculture</td>
<td style="text-align: center;">Fishing and Aquaculture</td>
<td style="text-align: center;">7</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Industry</td>
<td style="text-align: center;">Construction</td>
<td style="text-align: center;">197</td>
</tr>
<tr class="even">
<td style="text-align: center;">Industry</td>
<td style="text-align: center;">Electricity, Gas, Steam, AC Supply</td>
<td style="text-align: center;">3</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Industry</td>
<td style="text-align: center;">Manufacturing</td>
<td style="text-align: center;">220</td>
</tr>
<tr class="even">
<td style="text-align: center;">Industry</td>
<td style="text-align: center;">Mining and Quarrying</td>
<td style="text-align: center;">1</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Industry</td>
<td style="text-align: center;">Water Supply, Sewerage, Waste Management</td>
<td style="text-align: center;">6</td>
</tr>
<tr class="even">
<td style="text-align: center;">Services</td>
<td style="text-align: center;">Accommodation and Food Services</td>
<td style="text-align: center;">213</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Services</td>
<td style="text-align: center;">Administrative and Support Services</td>
<td style="text-align: center;">344</td>
</tr>
<tr class="even">
<td style="text-align: center;">Services</td>
<td style="text-align: center;">Arts, Entertainment and Recreation</td>
<td style="text-align: center;">25</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Services</td>
<td style="text-align: center;">Education</td>
<td style="text-align: center;">60</td>
</tr>
<tr class="even">
<td style="text-align: center;">Services</td>
<td style="text-align: center;">Financial and Insurance Activities</td>
<td style="text-align: center;">70</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Services</td>
<td style="text-align: center;">Human Health and Social Work</td>
<td style="text-align: center;">60</td>
</tr>
<tr class="even">
<td style="text-align: center;">Services</td>
<td style="text-align: center;">Information and Communication</td>
<td style="text-align: center;">73</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Services</td>
<td style="text-align: center;">Other Service Activities</td>
<td style="text-align: center;">196</td>
</tr>
<tr class="even">
<td style="text-align: center;">Services</td>
<td style="text-align: center;">Professional, Scientific, and Technical Activities</td>
<td style="text-align: center;">49</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Services</td>
<td style="text-align: center;">Public Administration and Defense</td>
<td style="text-align: center;">154</td>
</tr>
<tr class="even">
<td style="text-align: center;">Services</td>
<td style="text-align: center;">Real Estate Activities</td>
<td style="text-align: center;">32</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Services</td>
<td style="text-align: center;">Transportation and Storage</td>
<td style="text-align: center;">273</td>
</tr>
<tr class="even">
<td style="text-align: center;">Services</td>
<td style="text-align: center;">Wholesale and Retail Trade</td>
<td style="text-align: center;">584</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Total</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">2569</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Now we graph it to visualize the Frequency of Employed Persons by Sub-sector and Major Sector</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>freq_table2 <span class="ot">&lt;-</span> freq_table <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(major <span class="sc">!=</span> <span class="st">"Total"</span>)  <span class="co"># removes the row where 'major' is "Total"</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  freq_table2, </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">fct_rev</span>(<span class="fu">fct_reorder</span>(sub_sector, <span class="sc">-</span>n)),  </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> n, </span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> sub_sector</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>) <span class="sc">+</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> major, <span class="at">scales =</span> <span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Frequency of Employed Persons by Sub-sector and Major Sector"</span>,</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Sub-sector"</span>,   </span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Number of Persons"</span>,</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Sub-sector"</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">38</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, </span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>                               <span class="at">hjust =</span> <span class="dv">1</span>, </span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>                               <span class="at">size =</span> <span class="dv">25</span>),</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">70</span>, </span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>                               <span class="at">hjust =</span> <span class="dv">1</span>, </span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>                               <span class="at">size =</span> <span class="dv">25</span>),</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">legend.position =</span> <span class="st">"none"</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="ncr_employment_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="3360"></p>
</figure>
</div>
</div>
</div>
<p>Faceted bar graph shows the breakdown of employed individuals by different sub-sectors, classified by main sectors. Different facets depict various major sectors, enabling comparison of sub-sectoral employment both within and between sectors to be seen more clearly.</p>
<p>Under the Agriculture, Forestry, and Fishing sector, the highest employment is in Fishing and Aquaculture. Agriculture and Forestry also participate but to a lesser degree.</p>
<p>The Industry sector indicates high labor in Manufacturing and Construction, with overwhelming dominance of the group’s workforce. Other sub-sectors such as Water Supply and Electricity, Gas, Steam, and AC Supply have comparatively low employment.</p>
<p>In the Services sector, there is much diversification of employment. The Wholesale and Retail Trade sub-sector employs the largest number of people, followed by Administrative and Support Services, Transportation and Storage, and Accommodation and Food Services. Some other smaller sub-sectors also make contributions, including Financial and Insurance Activities, Education, and Public Administration.</p>
<p>In general, the Services sector also seems to be the most populous by employment, signaling a robust trend towards service job employment in the labor market. The distinction between color-coded bars and independent facets facilitates interpretability, allowing for easier observation of which sub-sectors predominate within each of the main economic sectors.</p>
</section>
</section>
</section>
<section id="notes" class="level1">
<h1>Notes</h1>
<p>A logistic regression model was tested to assess the predictive power of educational attainment on employment status. However, due to high insignificance across levels, likely caused by category imbalance and sample constraints, the results were excluded from the main analysis.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>